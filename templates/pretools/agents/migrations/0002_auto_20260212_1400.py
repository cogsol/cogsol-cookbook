# Generated by CogSol 0.2.0 on 2026-02-12 14:00
from cogsol.db import migrations


class Migration(migrations.Migration):
    initial = False
    dependencies = [('agents', '0001_initial')]
    operations = [
        migrations.AlterField(model_name='DailyTip', name='__code__', value='def run(self, chat=None, data=None, secrets=None, log=None):\n    from datetime import datetime, timezone, timedelta\n\n    if log:\n        log("DailyTipTool: selecting tip of the day")\n\n    tips = [\n        "Run `makemigrations` before `migrate` to review changes before deploying them.",\n        "Use `genconfigs.QA()` for conversational agents and `genconfigs.FastRetrieval()` for search-focused pretools.",\n        "Keep system prompts in separate Markdown files under prompts/ for easy editing.",\n        "Each tool should do one thing well — split complex logic into multiple tools.",\n        "Use `max_consecutive_tool_calls` to prevent infinite tool-call loops.",\n        "FAQs are matched by semantic similarity, while fixed responses use exact key matching.",\n        "Lessons shape the agent\'s behavior across all responses — use them for guidelines and best practices.",\n        "Store environment variables in `.env` and never commit credentials to version control.",\n        "Use `python manage.py chat --agent AgentName` to test your agent interactively after deploying.",\n        "Pretools run before the main generation phase — use them to gather context that enriches the agent\'s response.",\n    ]\n\n    tz = timezone(timedelta(hours=-3))\n    day_of_year = datetime.now(tz).timetuple().tm_yday\n    tip = tips[day_of_year % len(tips)]\n\n    if log:\n        log(f"DailyTipTool: tip #{day_of_year % len(tips) + 1}")\n\n    return {"tip": tip}', entity='tools', scope='fields'),
        migrations.AlterField(model_name='WeatherInfo', name='__code__', value='def run(self, chat=None, data=None, secrets=None, log=None):\n    import json\n    import urllib.request\n    import urllib.error\n\n    if log:\n        log("WeatherInfoTool: fetching weather from Open-Meteo API")\n\n    weather_codes = {\n        0: "Clear sky",\n        1: "Mainly clear",\n        2: "Partly cloudy",\n        3: "Overcast",\n        45: "Fog",\n        48: "Depositing rime fog",\n        51: "Light drizzle",\n        53: "Moderate drizzle",\n        55: "Dense drizzle",\n        61: "Slight rain",\n        63: "Moderate rain",\n        65: "Heavy rain",\n        71: "Slight snow fall",\n        73: "Moderate snow fall",\n        75: "Heavy snow fall",\n        77: "Snow grains",\n        80: "Slight rain showers",\n        81: "Moderate rain showers",\n        82: "Violent rain showers",\n        85: "Slight snow showers",\n        86: "Heavy snow showers",\n        95: "Thunderstorm",\n        96: "Thunderstorm with slight hail",\n        99: "Thunderstorm with heavy hail",\n    }\n\n    latitude = -34.9011\n    longitude = -56.1645\n\n    url = (\n        f"https://api.open-meteo.com/v1/forecast"\n        f"?latitude={latitude}&longitude={longitude}"\n        f"&current_weather=true"\n    )\n\n    try:\n        with urllib.request.urlopen(url, timeout=5) as response:\n            weather_data = json.loads(response.read().decode())\n\n        weather = weather_data["current_weather"]\n        code = weather.get("weathercode", -1)\n        condition = weather_codes.get(code, "Unknown")\n\n        result = {\n            "temperature_celsius": weather["temperature"],\n            "condition": condition,\n            "wind_speed_kmh": weather["windspeed"],\n            "location": "Montevideo, Uruguay",\n        }\n\n        if log:\n            log(\n                f"WeatherInfoTool: {result[\'temperature_celsius\']}°C, "\n                f"{result[\'condition\']}, wind {result[\'wind_speed_kmh\']} km/h"\n            )\n\n        return result\n\n    except (urllib.error.URLError, KeyError, ValueError) as exc:\n        if log:\n            log(f"WeatherInfoTool: error fetching weather — {exc}")\n        return {"error": "Could not fetch weather data."}', entity='tools', scope='fields'),
    ]
