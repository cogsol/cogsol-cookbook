# Generated by CogSol 0.2.0 on 2026-02-12 13:53
from cogsol.db import migrations


class Migration(migrations.Migration):
    initial = True
    dependencies = []
    operations = [
        migrations.CreateTool(name='CurrentDateTime', fields={'name': 'current_datetime', 'description': 'Returns the current date, time, day of the week, and period of the day for Montevideo (UTC-3). Call this tool to provide temporal context before responding to the user.', 'parameters': {}, '__code__': 'def run(self, chat=None, data=None, secrets=None, log=None):\n    from datetime import datetime, timezone, timedelta\n\n    if log:\n        log("CurrentDateTimeTool: fetching current date and time")\n\n    tz = timezone(timedelta(hours=-3))\n    now = datetime.now(tz)\n    hour = now.hour\n\n    if hour < 12:\n        period = "morning"\n    elif hour < 18:\n        period = "afternoon"\n    else:\n        period = "evening"\n\n    result = {\n        "date": now.strftime("%Y-%m-%d"),\n        "time": now.strftime("%H:%M"),\n        "day_of_week": now.strftime("%A"),\n        "period": period,\n        "timezone": "UTC-3 (Montevideo)",\n    }\n\n    if log:\n        log(f"CurrentDateTimeTool: {result[\'date\']} {result[\'time\']} ({period})")\n\n    return result'}),
        migrations.CreateTool(name='DailyTip', fields={'name': 'daily_tip', 'description': 'Returns a CogSol Framework tip of the day. The tip rotates automatically based on the current date.', 'TIPS': ['Run `makemigrations` before `migrate` to review changes before deploying them.', 'Use `genconfigs.QA()` for conversational agents and `genconfigs.FastRetrieval()` for search-focused pretools.', 'Keep system prompts in separate Markdown files under prompts/ for easy editing.', 'Each tool should do one thing well — split complex logic into multiple tools.', 'Use `max_consecutive_tool_calls` to prevent infinite tool-call loops.', 'FAQs are matched by semantic similarity, while fixed responses use exact key matching.', "Lessons shape the agent's behavior across all responses — use them for guidelines and best practices.", 'Store environment variables in `.env` and never commit credentials to version control.', 'Use `python manage.py chat --agent AgentName` to test your agent interactively after deploying.', "Pretools run before the main generation phase — use them to gather context that enriches the agent's response."], 'parameters': {}, '__code__': 'def run(self, chat=None, data=None, secrets=None, log=None):\n    from datetime import datetime, timezone, timedelta\n\n    if log:\n        log("DailyTipTool: selecting tip of the day")\n\n    tz = timezone(timedelta(hours=-3))\n    day_of_year = datetime.now(tz).timetuple().tm_yday\n    tip = self.TIPS[day_of_year % len(self.TIPS)]\n\n    if log:\n        log(f"DailyTipTool: tip #{day_of_year % len(self.TIPS) + 1}")\n\n    return {"tip": tip}'}),
        migrations.CreateTool(name='WeatherInfo', fields={'name': 'weather_info', 'description': 'Returns the current weather conditions for Montevideo including temperature, sky condition, and wind speed. Uses the free Open-Meteo API (no API key required).', 'WEATHER_CODES': {0: 'Clear sky', 1: 'Mainly clear', 2: 'Partly cloudy', 3: 'Overcast', 45: 'Fog', 48: 'Depositing rime fog', 51: 'Light drizzle', 53: 'Moderate drizzle', 55: 'Dense drizzle', 61: 'Slight rain', 63: 'Moderate rain', 65: 'Heavy rain', 71: 'Slight snow fall', 73: 'Moderate snow fall', 75: 'Heavy snow fall', 77: 'Snow grains', 80: 'Slight rain showers', 81: 'Moderate rain showers', 82: 'Violent rain showers', 85: 'Slight snow showers', 86: 'Heavy snow showers', 95: 'Thunderstorm', 96: 'Thunderstorm with slight hail', 99: 'Thunderstorm with heavy hail'}, 'LATITUDE': -34.9011, 'LONGITUDE': -56.1645, 'parameters': {}, '__code__': 'def run(self, chat=None, data=None, secrets=None, log=None):\n    import json\n    import urllib.request\n    import urllib.error\n\n    if log:\n        log("WeatherInfoTool: fetching weather from Open-Meteo API")\n\n    url = (\n        f"https://api.open-meteo.com/v1/forecast"\n        f"?latitude={self.LATITUDE}&longitude={self.LONGITUDE}"\n        f"&current_weather=true"\n    )\n\n    try:\n        with urllib.request.urlopen(url, timeout=5) as response:\n            data = json.loads(response.read().decode())\n\n        weather = data["current_weather"]\n        code = weather.get("weathercode", -1)\n        condition = self.WEATHER_CODES.get(code, "Unknown")\n\n        result = {\n            "temperature_celsius": weather["temperature"],\n            "condition": condition,\n            "wind_speed_kmh": weather["windspeed"],\n            "location": "Montevideo, Uruguay",\n        }\n\n        if log:\n            log(\n                f"WeatherInfoTool: {result[\'temperature_celsius\']}°C, "\n                f"{result[\'condition\']}, wind {result[\'wind_speed_kmh\']} km/h"\n            )\n\n        return result\n\n    except (urllib.error.URLError, KeyError, ValueError) as exc:\n        if log:\n            log(f"WeatherInfoTool: error fetching weather — {exc}")\n        return {"error": "Could not fetch weather data."}'}),
        migrations.CreateAgent(name='PretoolsAgent', fields={'system_prompt': '# Pretools Assistant\n\nYou are a helpful assistant that demonstrates the use of pretools in the CogSol Framework.\n\n## Your Role\n\n- Before each response, your pretools automatically gather context: current date and time, weather conditions, and a daily tip.\n- Use this context naturally in your responses. For example, greet the user with the appropriate time of day, mention the weather, and share the tip when relevant.\n- Answer general questions about the CogSol Framework when asked.\n\n## Guidelines\n\n1. Always incorporate pretool data naturally into your responses — do not list raw JSON.\n2. Greet the user with the appropriate time-of-day greeting (good morning, good afternoon, good evening) based on the current time.\n3. Mention weather conditions conversationally when greeting or when the user asks.\n4. Share the daily tip proactively on the first interaction or when the user asks for advice.\n5. Be concise and friendly.\n6. If you lack information on a topic, say so clearly and refer users to https://docs.cogsol.ai.', 'generation_config': 'QA', 'pregeneration_config': 'fast_retrieval', 'temperature': 0.3, 'max_responses': 10, 'max_msg_length': 2048, 'max_consecutive_tool_calls': 3, 'pretools': ['current_datetime', 'weather_info', 'daily_tip'], 'initial_message': 'Hello! I am the Pretools Assistant. I use pre-processing tools to gather real-time context before responding. Ask me anything and I will include current date, weather, and a daily tip in my response.', 'forced_termination_message': 'Thank you for using the Pretools Assistant. Visit https://docs.cogsol.ai for the full reference.', 'no_information_message': "I don't have specific information about that topic. Please check the official documentation at https://docs.cogsol.ai.", 'name': 'Pretools'}, meta={'name': 'PretoolsAgent', 'chat_name': 'Pretools Assistant'}),
    ]
