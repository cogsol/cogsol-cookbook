# Generated by CogSol 0.2.0 on 2026-02-28 09:47
from cogsol.db import migrations


class Migration(migrations.Migration):
    initial = True
    dependencies = []
    operations = [
        migrations.CreateRetrievalTool(name='HelpDeskSearch', fields={'description': 'Search the IT knowledge base for troubleshooting guides, policies, and how-to articles.', 'parameters': [], 'name': 'HelpDeskSearch'}),
        migrations.CreateTool(name='CreateTicket', fields={'name': 'create_ticket', 'description': "Create a support ticket when the user's issue cannot be resolved with existing knowledge base articles or FAQs. Use this as a last resort after searching the knowledge base.", 'show_tool_message': False, 'parameters': {'subject': {'description': 'Short summary of the issue for the ticket title.', 'type': 'string', 'required': True}, 'description': {'description': 'Detailed description of the issue including steps to reproduce.', 'type': 'string', 'required': True}, 'priority': {'description': 'Ticket priority: low, medium, or high.', 'type': 'string', 'required': False}}, '__code__': '@tool_params(\n    subject={\n        "description": "Short summary of the issue for the ticket title.",\n        "type": "string",\n        "required": True,\n    },\n    description={\n        "description": "Detailed description of the issue including steps to reproduce.",\n        "type": "string",\n        "required": True,\n    },\n    priority={\n        "description": "Ticket priority: low, medium, or high.",\n        "type": "string",\n        "required": False,\n    },\n)\ndef run(self, subject="", description="", priority="medium", chat=None, data=None, log=None):\n    import json\n    import requests\n\n    url = "https://jsonplaceholder.typicode.com/posts"\n\n    payload = {\n        "title": subject,\n        "body": f"Priority: {priority}\\n\\n{description}",\n        "userId": 1,\n    }\n\n    try:\n        log.append(f"POST {url}")\n        resp = requests.post(url, json=payload, timeout=30)\n        resp.raise_for_status()\n\n        result = resp.json()\n        ticket_id = result.get("id", "N/A")\n        log.append(f"Ticket created: #{ticket_id}")\n        return f"Ticket #{ticket_id} created: {subject}"\n\n    except requests.exceptions.Timeout:\n        log.append("Request timed out")\n        return "Could not create the ticket: request timed out. Please try again later."\n    except requests.exceptions.HTTPError:\n        log.append(f"HTTP error: {resp.status_code}")\n        return f"Could not create the ticket: API returned {resp.status_code}."\n    except Exception as e:\n        log.append(f"Request error: {str(e)}")\n        return f"Could not create the ticket: {str(e)}"'}),
        migrations.CreateAgent(name='SupportEscalationAgent', fields={'system_prompt': '# IT Help Desk Assistant\n\nYou are a corporate IT help desk assistant. Your goal is to help employees resolve technical issues quickly and efficiently.\n\n## Guidelines\n\n- Search the knowledge base before suggesting a ticket.\n- Only create a ticket when the knowledge base does not have a solution.\n- Always confirm the issue details with the user before creating a ticket.\n- Be concise and use step-by-step instructions when possible.', 'generation_config': 'QA', 'temperature': 0.3, 'max_responses': 10, 'max_msg_length': 2048, 'max_consecutive_tool_calls': 3, 'tools': ['HelpDeskSearch', 'create_ticket'], 'initial_message': 'Hello! I am the IT Help Desk Assistant. I can help you with network issues, printer setup, VPN access, software licenses, and more. If I cannot find a solution, I will create a support ticket for you.', 'forced_termination_message': 'We are ending this conversation to preserve security and integrity.', 'no_information_message': 'I could not find information about that topic. Would you like me to create a support ticket so a technician can assist you?', 'faqs': ['EquipmentRequestFAQ', 'MobileEmailFAQ', 'PasswordResetFAQ', 'SoftwareInstallFAQ', 'TicketingProcessFAQ', 'VpnAccessFAQ'], 'fixed_responses': ['contact_info', 'emergency_support', 'office_hours', 'office_locations'], 'name': 'SupportEscalation'}, meta={'name': 'SupportEscalationAgent', 'chat_name': 'IT Help Desk Assistant'}),
        migrations.CreateFAQ(name='SupportEscalationAgent::How do I request new equipment like a laptop or monitor?', fields={'name': 'How do I request new equipment like a laptop or monitor?', 'content': 'To request new equipment:\n\n1. Log in to the self-service portal: https://helpdesk.company.com\n2. Go to Service Catalog > Hardware Requests\n3. Select the item you need and fill out the request form\n4. Your manager will receive an approval notification\n\nStandard equipment is delivered within 5-7 business days after approval. Urgent requests require manager escalation.', 'meta': {'topic': None, 'context_of_application': None}, 'agent': 'SupportEscalationAgent'}),
        migrations.CreateFAQ(name='SupportEscalationAgent::How do I set up work email on my personal phone?', fields={'name': 'How do I set up work email on my personal phone?', 'content': "To set up corporate email on your mobile device:\n\n1. Install Microsoft Outlook from your app store\n2. Open Outlook and tap 'Add Account'\n3. Enter your work email address\n4. Sign in with your corporate credentials\n5. Approve the MFA prompt\n6. Accept the device management policy when prompted\n\nNote: The company MDM policy will be applied to your device. This requires a screen lock and allows remote wipe of corporate data only.", 'meta': {'topic': None, 'context_of_application': None}, 'agent': 'SupportEscalationAgent'}),
        migrations.CreateFAQ(name='SupportEscalationAgent::How do I reset my password?', fields={'name': 'How do I reset my password?', 'content': "To reset your password:\n\n1. Go to https://password.company.com\n2. Click 'Forgot Password'\n3. Enter your employee email address\n4. Follow the link sent to your email\n5. Create a new password (min. 12 characters, one uppercase, one number, one special character)\n\nIf you are locked out, contact the Help Desk to verify your identity and unlock your account.", 'meta': {'topic': None, 'context_of_application': None}, 'agent': 'SupportEscalationAgent'}),
        migrations.CreateFAQ(name='SupportEscalationAgent::How do I install new software on my work computer?', fields={'name': 'How do I install new software on my work computer?', 'content': "To install approved software:\n\n1. Open Software Center (pre-installed on all company devices)\n2. Browse or search for the application you need\n3. Click 'Install' and wait for completion\n\nIf the software is not listed in Software Center, submit a request at https://helpdesk.company.com > Service Catalog > Software Requests. The IT team will review and approve within 2 business days.", 'meta': {'topic': None, 'context_of_application': None}, 'agent': 'SupportEscalationAgent'}),
        migrations.CreateFAQ(name='SupportEscalationAgent::How does the ticketing system work?', fields={'name': 'How does the ticketing system work?', 'content': 'Our ticketing system tracks all IT requests:\n\n1. Tickets are created automatically when you email helpdesk@company.com or submit a request via the portal\n2. You receive a ticket number for tracking\n3. A technician is assigned based on the issue category\n4. You can check status at https://helpdesk.company.com > My Tickets\n\nResponse times: Critical (1 hour), High (4 hours), Medium (1 business day), Low (3 business days).', 'meta': {'topic': None, 'context_of_application': None}, 'agent': 'SupportEscalationAgent'}),
        migrations.CreateFAQ(name='SupportEscalationAgent::How do I connect to the company VPN?', fields={'name': 'How do I connect to the company VPN?', 'content': 'To connect to the VPN:\n\n1. Install GlobalProtect from the Software Center\n2. Open GlobalProtect and enter portal: vpn.company.com\n3. Sign in with your corporate credentials\n4. Approve the MFA prompt on your authenticator app\n\nThe VPN is required for accessing internal resources when working remotely. If connection fails, check that your internet is working and your credentials are correct.', 'meta': {'topic': None, 'context_of_application': None}, 'agent': 'SupportEscalationAgent'}),
        migrations.CreateFixedResponse(name='SupportEscalationAgent::contact_info', fields={'name': 'contact_info', 'content': 'IT Help Desk Contact Information:\n\n- Email: helpdesk@company.com\n- Phone: +1 (555) 100-HELP\n- Internal chat: #it-support on Teams\n- Self-service portal: https://helpdesk.company.com\n- Walk-in: Building A, 2nd Floor, Room 210', 'meta': {'topic': 'contact_info', 'context_of_application': None}, 'agent': 'SupportEscalationAgent'}),
        migrations.CreateFixedResponse(name='SupportEscalationAgent::emergency_support', fields={'name': 'emergency_support', 'content': 'For IT Emergencies (system outages, security incidents):\n\n1. Call the emergency line: +1 (555) 911-HELP (24/7)\n2. Email: emergency@company.com\n3. If you suspect a security breach, also notify security@company.com\n\nDo NOT attempt to fix security incidents on your own. Disconnect affected devices from the network and wait for IT response.', 'meta': {'topic': 'emergency_support', 'context_of_application': None}, 'agent': 'SupportEscalationAgent'}),
        migrations.CreateFixedResponse(name='SupportEscalationAgent::office_hours', fields={'name': 'office_hours', 'content': 'IT Help Desk Hours:\n\n- Monday to Friday: 8:00 AM - 6:00 PM (local time)\n- Saturday: 9:00 AM - 1:00 PM (limited support)\n- Sunday and holidays: Closed\n\nFor emergencies outside business hours, call the on-call line at +1 (555) 911-HELP.', 'meta': {'topic': 'office_hours', 'context_of_application': None}, 'agent': 'SupportEscalationAgent'}),
        migrations.CreateFixedResponse(name='SupportEscalationAgent::office_locations', fields={'name': 'office_locations', 'content': 'IT Support Locations:\n\n- Headquarters: Building A, 2nd Floor, Room 210\n- West Campus: Building C, Ground Floor, Room 003\n- Remote Support: Available via Teams or phone\n\nWalk-in support is available during business hours. Please bring your employee badge for identification.', 'meta': {'topic': 'office_locations', 'context_of_application': None}, 'agent': 'SupportEscalationAgent'}),
    ]
